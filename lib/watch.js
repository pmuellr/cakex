// Generated by CoffeeScript 1.9.0
var Gaze, cakex, fs, path, _;

fs = require("fs");

path = require("path");

_ = require("underscore");

Gaze = require("gaze").Gaze;

cakex = require("./cakex");

exports.watch = function(_arg) {
  var fileSpecs, gaze, run;
  fileSpecs = _arg.fileSpecs, run = _arg.run;
  gaze = new Gaze(fileSpecs);
  gaze.watched(function(err, files) {
    if (err != null) {
      log("error getting watched files: " + err);
      return;
    }
    return log("watching " + files.length + " files for changes ...");
  });
  return gaze.on("all", function(event, file) {
    var err;
    if (file != null) {
      cakex.log("----------------------------------------------------");
      cakex.log("file changed: " + file + " on " + (new Date));
    }
    try {
      run(file);
    } catch (_error) {
      err = _error;
      cakex.log("error running watch function: " + err);
      cakex.log(err.stack);
    }
    gaze.close();
    return exports.watch({
      fileSpecs: fileSpecs,
      run: run
    });
  });
};

//# sourceMappingURL=watch.js.map
